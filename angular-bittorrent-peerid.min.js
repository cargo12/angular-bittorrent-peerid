"use strict";angular.module("angularBittorrentPeerid",[]),angular.module("angularBittorrentPeerid").run(function(){"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(a){return this.slice(-a.length)===a}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a,b){return b=b||0,this.slice(b,b+a.length)===a})}),angular.module("angularBittorrentPeerid").factory("peeridUtils",function(){function a(a){var b=a.charCodeAt(0);return b>="0".charCodeAt(0)&&b<="9".charCodeAt(0)}function b(a){var b=a.toLowerCase().charCodeAt(0);return b>="a".charCodeAt(0)&&b<="z".charCodeAt(0)}function c(c){return a(c)||b(c)||"."===c}function d(a,b){b=b||0;for(var c=""+(255&a);c.length<b;)c="0"+c;return c}return{getUtf8Data:function(a){var c,d,b=[];for(c=0;c<a.length;c++)d=a.charCodeAt(c),128>d?b.push(d):2048>d?b.push(192|d>>6,128|63&d):b.push(224|d>>12,128|63&d>>6,128|63&d);return b},isAzStyle:function(a){return"-"!==a.charAt(0)?!1:"-"===a.charAt(7)?!0:"FG"===a.substring(1,3)?!0:"LH"===a.substring(1,3)?!0:"NE"===a.substring(1,3)?!0:"KT"===a.substring(1,3)?!0:"SP"===a.substring(1,3)?!0:!1},isShadowStyle:function(d){var e,f,g;if("-"!==d.charAt(5))return!1;if(!b(d.charAt(0)))return!1;if(!a(d.charAt(1))&&"-"!==d.charAt(1))return!1;for(e=4;e>0&&"-"===d.charAt(e);e--);for(f=1;e>=f;f++){if(g=d.charAt(f),"-"===g)return!1;if(null===c(g))return!1}return!0},isMainlineStyle:function(a){return"-"===a.charAt(2)&&"-"===a.charAt(7)&&("-"===a.charAt(4)||"-"===a.charAt(5))},isPossibleSpoofClient:function(a){return a.endsWith("UDP0")||a.endsWith("HTTPBT")},decodeNumericValueOfByte:d,getAzStyleVersionNumber:function(a,b){return"function"==typeof b?b(a):null},getShadowStyleVersionNumber:function(){return null},decodeBitSpiritClient:function(a,b){if("BS"!==a.substring(2,4))return null;var c=""+b[1];return"0"===c&&(c=1),{client:"BitSpirit",version:c}},decodeBitCometClient:function(a,b){var e,f,g,h,c="";if(a.startsWith("exbc"))c="";else if(a.startsWith("FUTB"))c="(Solidox Mod)";else{if(!a.startsWith("xUTB"))return null;c="(Mod 2)"}return e="LORD"===a.substring(6,10),f=e?"BitLord":"BitComet",g=d(b[4]),h=e&&"0"!==g?1:2,{client:f+(c?" "+c:""),version:g+"."+d(b[5],h)}},identifyAwkwardClient:function(a,b){var d,e,c=20;for(d=0;20>d;++d)if(b[d]>0){c=d;break}if(0===c){for(e=!0,d=0;16>d;++d)if(0===b[d]){e=!1;break}if(e){for(d=16;20>d;++d)if(b[d]!==(b[d%16]^b[15-d%16])){e=!1;break}if(e)return{client:"Shareaza"}}}return 9===c&&3===b[9]&&3===b[10]&&3===b[11]?{client:"I2PSnark"}:12===c&&97===b[12]&&97===b[13]?{client:"Experimental",version:"3.2.1b2"}:12===c&&0===b[12]&&0===b[13]?{client:"Experimental",version:"3.1"}:12===c?{client:"Mainline"}:null}}}),angular.module("angularBittorrentPeerid").provider("bittorrentPeeridService",function(){var a="unknown",b="fake",c={},d={},e={},f={},g={},h=[],i=function(a){return a[0]+"."+a[1]+"."+a[2]},j=function(a){var b="ABCDE";return isNaN(a[2])?a[0]+"."+a[1]+".1"+b.indexOf(a[2]):a[0]+"."+a[1]+"."+a[2]},k=function(a){var b=a[3];return b="B"==b?"Beta":"A"==b?"Alpha":"",a[0]+"."+a[1]+"."+a[2]+" "+b},l=function(a){return a[0]+"."+a[1]+"."+a[2]+"."+a[3]},m=function(a){return a[0]+a[1]+"."+a[2]+a[3]},n=function(a){return a[1]+"."+a[2]+a[3]},o="1.2.3=[RD].4",p=function(a){return"0"==a[0]&&"0"==a[1]&&"0"==a[2]?"0."+a[3]:"0"==a[0]&&"0"==a[1]?"0."+a[2]+a[3]:a[0]+"."+a[1]+a[2]+("Z"==a[3]||"X"==a[3]?"+":"")},q="2.33.4",r="NO_VERSION",s=this.addAzStyle=function(a,b,e){e=e||l,c[a]=b,d[b]=e},t=this.addShadowStyle=function(a,b,c){c=c||i,e[a]=b,f[b]=c},u=this.addMainlineStyle=function(a,b){g[a]=b},v=this.addSimpleClient=function(a,b,c,d){("number"==typeof c||"undefined"==typeof c)&&(d=c,c=b,b=void 0),h.push({id:c,client:a,version:b,position:d||0})};!function(){s("A~","Ares",i),s("AG","Ares",i),s("AN","Ares",l),s("AR","Ares"),s("AV","Avicora"),s("AX","BitPump",m),s("AT","Artemis"),s("AZ","Vuze",l),s("BB","BitBuddy","1.234"),s("BC","BitComet",n),s("BE","BitTorrent SDK"),s("BF","BitFlu",r),s("BG","BTG",l),s("bk","BitKitten (libtorrent)"),s("BR","BitRocket","1.2(34)"),s("BS","BTSlave"),s("BT","BitTorrent",k),s("BW","BitWombat"),s("BX","BittorrentX"),s("CB","Shareaza Plus"),s("CD","Enhanced CTorrent",m),s("CT","CTorrent","1.2.34"),s("DP","Propogate Data Client"),s("DE","Deluge",j),s("EB","EBit"),s("ES","Electric Sheep",i),s("FC","FileCroc"),s("FG","FlashGet",n),s("FT","FoxTorrent/RedSwoosh"),s("GR","GetRight","1.2"),s("GS","GSTorrent"),s("HL","Halite",i),s("HN","Hydranode"),s("KG","KGet"),s("KT","KTorrent",o),s("LC","LeechCraft"),s("LH","LH-ABC"),s("LK","linkage",i),s("LP","Lphant",m),s("LT","libtorrent (Rasterbar)",q),s("lt","libTorrent (Rakshasa)",q),s("LW","LimeWire",r),s("MO","MonoTorrent"),s("MP","MooPolice",i),s("MR","Miro"),s("MT","MoonlightTorrent"),s("NE","BT Next Evolution",i),s("NX","Net Transport"),s("OS","OneSwarm",l),s("OT","OmegaTorrent"),s("PC","CacheLogic","12.3-4"),s("PT","Popcorn Time"),s("PD","Pando"),s("PE","PeerProject"),s("pX","pHoeniX"),s("qB","qBittorrent",j),s("QD","qqdownload"),s("RT","Retriever"),s("RZ","RezTorrent"),s("S~","Shareaza alpha/beta"),s("SB","SwiftBit"),s("SD","迅雷在线 (Xunlei)"),s("SG","GS Torrent",l),s("SN","ShareNET"),s("SP","BitSpirit",i),s("SS","SwarmScope"),s("ST","SymTorrent","2.34"),s("st","SharkTorrent"),s("SZ","Shareaza"),s("TN","Torrent.NET"),s("TR","Transmission",p),s("TS","TorrentStorm"),s("TT","TuoTu",i),s("UL","uLeecher!"),s("UE","µTorrent Embedded",k),s("UT","µTorrent",k),s("UM","µTorrent Mac",k),s("WT","Bitlet"),s("WW","WebTorrent"),s("WY","FireTorrent"),s("VG","哇嘎 (Vagaa)",l),s("XL","迅雷在线 (Xunlei)"),s("XT","XanTorrent"),s("XF","Xfplay",p),s("XX","XTorrent","1.2.34"),s("XC","XTorrent","1.2.34"),s("ZT","ZipTorrent"),s("7T","aTorrent"),s("ZO","Zona",l),s("#@","Invalid PeerID"),t("A","ABC"),t("O","Osprey Permaseed"),t("Q","BTQueue"),t("R","Tribler"),t("S","Shad0w"),t("T","BitTornado"),t("U","UPnP NAT"),u("M","Mainline"),u("Q","Queen Bee"),v("µTorrent","1.7.0 RC","-UT170-"),v("Azureus","1","Azureus"),v("Azureus","2.0.3.2","Azureus",5),v("Aria","2","-aria2-"),v("BitTorrent Plus!","II","PRC.P---"),v("BitTorrent Plus!","P87.P---"),v("BitTorrent Plus!","S587Plus"),v("BitTyrant (Azureus Mod)","AZ2500BT"),v("Blizzard Downloader","BLZ"),v("BTGetit","BG",10),v("BTugaXP","btuga"),v("BTugaXP","BTuga",5),v("BTugaXP","oernu"),v("Deadman Walking","BTDWV-"),v("Deadman","Deadman Walking-"),v("External Webseed","Ext"),v("G3 Torrent","-G3"),v("GreedBT","2.7.1","271-"),v("Hurricane Electric","arclight"),v("HTTP Seed","-WS"),v("JVtorrent","10-------"),v("Limewire","LIME"),v("Martini Man","martini"),v("Pando","Pando"),v("PeerApp","PEERAPP"),v("SimpleBT","btfans",4),v("Swarmy","a00---0"),v("Swarmy","a02---0"),v("Teeweety","T00---0"),v("TorrentTopia","346-"),v("XanTorrent","DansClient"),v("MediaGet","-MG1"),v("MediaGet","2.1","-MG21"),v("Amazon AWS S3","S3-"),v("BitTorrent DNA","DNA"),v("Opera","OP"),v("Opera","O"),v("Burst!","Mbrst"),v("TurboBT","turbobt"),v("BT Protocol Daemon","btpd"),v("Plus!","Plus"),v("XBT","XBT"),v("BitsOnWheels","-BOW"),v("eXeem","eX"),v("MLdonkey","-ML"),v("Bitlet","BitLet"),v("AllPeers","AP"),v("BTuga Revolution","BTM"),v("Rufus","RS",2),v("BitMagnet","BM",2),v("QVOD","QVOD"),v("Top-BT","TB"),v("Tixati","TIX"),v("folx","-FL"),v("µTorrent Mac","-UM"),v("µTorrent","-UT")}(),this.$get=["peeridUtils",function(f){var i=function(a){return c[a.substring(1,3)]},j=function(a){return e[a.substring(0,1)]},k=function(a){return g[a.substring(0,1)]},l=function(a){var b,c;for(b=0;b<h.length;++b)if(c=h[b],a.startsWith(c.id,c.position))return c;return null},m=function(a,b){var c=d[a];return c?f.getAzStyleVersionNumber(b.substring(3,7),c):null},n=function(c){var d=f.getUtf8Data(c),e=null,g=null,h=null;return f.isPossibleSpoofClient(c)?(e=f.decodeBitSpiritClient(c,d))?e:(e=f.decodeBitCometClient(c,d))?e:{client:"BitSpirit?"}:f.isAzStyle(c)&&(e=i(c))?(g=m(e,c),e.startsWith("ZipTorrent")&&c.startsWith("bLAde",8)?{client:a+" ["+b+": "+name+"]",version:g}:"µTorrent"===e&&"6.0 Beta"===g?{client:"Mainline",version:"6.0 Beta"}:e.startsWith("libTorrent (Rakshasa)")?{client:e+" / rTorrent*",version:g}:{client:e,version:g}):f.isShadowStyle(c)&&(e=j(c))?{client:e}:f.isMainlineStyle(c)&&(e=k(c))?{client:e}:(e=f.decodeBitSpiritClient(c,d))?e:(e=f.decodeBitCometClient(c,d))?e:(h=l(c))?(e=h.client,{client:e,version:h.version}):(e=f.identifyAwkwardClient(c,d))?e:{client:"unknown"}};return{parseClient:n}}]});